name: Publish Package to npmjs

# è§¦å‘å·¥ä½œæµç¨‹çš„äº‹ä»¶
on:
  push:
    branches: [ main ]
 
# æŒ‰é¡ºåºè¿è¡Œä½œä¸š   
jobs:
  build:
    # æŒ‡å®šçš„è¿è¡Œå™¨ç¯å¢ƒ
    runs-on: ubuntu-latest

    # è®¾ç½®nodeç‰ˆæœ¬
    strategy:
      matrix:
        node-version: [16]

    steps:
      # æ‹‰å–githubä»“åº“ä»£ç 
      - uses: actions/checkout@v3
      # è®¾å®šnodeç¯å¢ƒ
      - uses: actions/setup-node@v3
        with:
          node-version: ${{ matrix.node-version }}
          # è®¾ç½®npmåœ°å€ä»“åº“
          registry-url: 'https://registry.npmjs.org'

      # - name: å®‰è£…ä¾èµ–ğŸ“¦ï¸
      #   run: npm install

      # - name: æ„å»ºğŸ“¦ï¸
      #   run: npm run build
      
      - name: å‘å¸ƒnpmä»“åº“
        env:
          NODE_AUTH_TOKEN: ${{secrets.NPM_AUTH_TOKEN}}
        run: npm run push

          
      # # å®‰è£…ä¾èµ–(ç›¸å½“äº npm ci)
      # - name: å®‰è£…ä¾èµ– ğŸ“¦ï¸
      #   run: npm install

      # # æ„å»º
      # - name: æ„å»º ğŸ“¦ï¸
      #   run: npm run build

      # # éƒ¨ç½²
      # - name: éƒ¨ç½² ğŸ“¦ï¸
      # # actionä¼šæ ¹æ®é…ç½®è‡ªåŠ¨æ¨é€ä»£ç åˆ°æŒ‡å®šåˆ†æ”¯
      #   uses: JamesIves/github-pages-deploy-action@releases/v3
      #   with:
      #     # æŒ‡å®šå¯†é’¥ï¼Œå³åœ¨ç¬¬ä¸€æ­¥ä¸­è®¾ç½®çš„
      #     ACCESS_TOKEN: ${{ secrets.ACCESS_TOKEN }}
      #     # æŒ‡å®šæ¨é€åˆ°çš„è¿œç¨‹åˆ†æ”¯
      #     BRANCH: pages
      #     # æŒ‡å®šæ„å»ºä¹‹åçš„äº§ç‰©è¦æ¨é€å“ªä¸ªç›®å½•çš„ä»£ç 
      #     FOLDER: dist
      # - run: npm publish
      #   env:
      #     # è®¾ç½®çš„ NPM_AUTH_TOKEN
      #     NODE_AUTH_TOKEN: ${{ secrets.NPM_AUTH_TOKEN }}
      #     
      #  ---------------------------------------------------
      #  - name: ç¼–è¯‘éƒ¨ç½²ui
      #   working-directory: 'package/vitevui' # å› ä¸ºä»£ç é‡‡ç”¨çš„monorepo æ‰€ä»¥éœ€è¦è¿›å…¥åŒ…çš„ç›®å½•æ¥è¿è¡Œ
      #   run: yarn build
        
      # - name: publish # å‘npm publish ä»£ç  è¯·éµå¾ªnpmè§„èŒƒ.
      #   working-directory: 'package/vitevui'
      #   env:
      #     NODE_AUTH_TOKEN: ${{secrets.NPM_TOKEN}} # è¯¥tokenæ˜¯ npmçš„token è·å–npm tokenè¯·æŸ¥çœ‹ æ­¥éª¤2 çš„åˆ›å»º npm token å’Œ å°†npm token æ”¾å…¥githubçš„ secretsä¸‹
      #   run: npm publish
